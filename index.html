<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sootravyooh - Live Scoreboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#121212;color:#e0e0e0;}
section{margin:120px auto 20px;padding:20px;width:90%;max-width:1000px;background:#1e1e1e;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.4);}
h2{color:#ffcc00;text-align:center;margin-bottom:20px;}
.teamBox{margin:15px 0;padding:15px;border:1px solid #333;border-radius:12px;background:#2b2b2b;box-shadow:0 4px 10px rgba(0,0,0,0.5);}
.teamBox strong{display:block;margin-bottom:12px;font-size:1.2em;}
.roundCard{margin:8px 0;padding:12px;background:#1e1e1e;border:1px solid #444;border-radius:10px;box-shadow:0 3px 6px rgba(0,0,0,0.5);display:flex;justify-content:space-between;flex-wrap:wrap;}
.roundCard div{margin:3px;}
.roundName{font-weight:bold;color:#ffcc00;}
canvas{width:100% !important;height:auto !important;border-radius:6px;margin-top:15px;}
@media screen and (max-width:768px){.roundCard{flex-direction:column;align-items:flex-start;}.teamBox{font-size:0.9em;}}
</style>
</head>
<body>

<section>
<h2>Team Scores</h2>
<div id="scorePanel"></div>
</section>

<section>
<h2>Score Trend Per Round</h2>
<canvas id="trendChart"></canvas>
</section>

<script>
const repoOwner="YOUR_USERNAME";
const repoName="YOUR_REPO";
const filePath="scores.json";
let teams=[];
let chart;

async function fetchScores(){
  try{
    const res=await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`);
    const data=await res.json();
    const content=JSON.parse(atob(data.content));
    teams=content.teams;
    updateUI();
  }catch(e){ console.error(e); document.getElementById("scorePanel").innerHTML="<p>Unable to fetch scores.</p>"; }
}

function updateUI(){
  const scorePanel=document.getElementById("scorePanel"); scorePanel.innerHTML="";
  teams.forEach(t=>{
    const div=document.createElement("div"); div.className="teamBox";
    div.innerHTML=`<strong>${t.name}</strong>`;
    t.scores.forEach((score,i)=>{
      const roundDiv=document.createElement("div"); roundDiv.className="roundCard";
      roundDiv.innerHTML=`<div class="roundName">Round ${i+1}</div><div>Score: ${score}</div>`;
      div.appendChild(roundDiv);
    });
    scorePanel.appendChild(div);
  });
  updateGraph();
}

function updateGraph(){
  const ctx=document.getElementById("trendChart").getContext("2d");
  if(chart) chart.destroy();
  if(teams.length===0) return;
  const rounds=teams[0].scores.length;
  const labels=Array.from({length:rounds},(_,i)=>"Round "+(i+1));
  const datasets=teams.map(t=>({label:t.name,data:t.scores.map((s,i)=>t.scores.slice(0,i+1).reduce((a,b)=>a+b,0)),borderColor:getRandomColor(),backgroundColor:"transparent",tension:0.4,fill:false,pointRadius:5,pointHoverRadius:7,borderWidth:3}));
  chart=new Chart(ctx,{type:"line",data:{labels,datasets},options:{responsive:true,plugins:{legend:{display:true,position:"bottom",labels:{color:"#ffcc00"}}},scales:{x:{ticks:{color:"#ffcc00"}},y:{beginAtZero:true,ticks:{color:"#ffcc00"}}}}});
}

function getRandomColor(){ return "hsl(" + Math.random()*360 + ",70%,60%)"; }

fetchScores();
setInterval(fetchScores,5000);
</script>
</body>
</html>
